<!-- Responsive Order Details Section -->
<section class="my-5">
    <div class="container main-body">
        <div class="row g-4">
            <!-- Sidebar/Profile -->
            <div class="col-12 col-lg-4 mb-4 mb-lg-0">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex flex-column align-items-center text-center">
                            <img src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="Admin"
                                class="rounded-circle p-1 bg-warning" width="110">
                            <div class="mt-3">
                                <h4>{{userdetails.name}}</h4>
                                <p class="text-secondary mb-1">{{userdetails.email}}</p>
                                <p class="text-muted font-size-sm">{{userAddress.city + ' , '+ userAddress.state}}</p>
                            </div>
                        </div>
                        <div class="list-group list-group-flush text-center mt-4">
                            <a class="list-group-item list-group-item-action border-0">
                                Profile Information
                            </a>
                            <a (click)="screentoggle('Orders')" class="list-group-item list-group-item-action border-0"
                                [class.active]="isOrder || isSpecorder">Orders</a>
                            <a *ngIf="isAdd" class="list-group-item list-group-item-action border-0"
                                [class.active]="isAdd">Address Book</a>
                            <a href="#" class="list-group-item list-group-item-action border-0"
                                (click)="logout()">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Specific Order Details -->
            <div class="col-12 col-lg-8" *ngIf="isSpecorder">
                <div>
                    <div class="card mt-4 mt-lg-0">
                        <div class="card-body p-0 table-responsive">
                            <div
                                class="d-flex flex-column flex-md-row justify-content-between align-items-center border-bottom">
                                <h4 class="p-3 mb-0">Order OverView</h4>
                                <label for="download" class="p-3 mb-0" style="cursor: pointer"
                                    (click)="downloadInvoice()">Save Invoice</label>
                            </div>
                            <div class="table-responsive">
                                <table class="table mb-0">
                                    <thead>
                                        <tr>
                                            <th scope="col">Product</th>
                                            <th scope="col">Quantity</th>
                                            <th scope="col" colspan="2">Price</th>
                                            <th scope="col">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let order of specOrders; let i = index">
                                            <td>{{order.product.name}}</td>
                                            <td>{{order.quantity}}</td>
                                            <td colspan="2"><strong>₹ {{order.price}}</strong></td>
                                            <td><strong>₹ {{order.quantity * order.price}}</strong></td>
                                        </tr>
                                        <tr>
                                            <th colspan="2">
                                                LogisticsPartner : <span>{{logisticsPartner || 'We are processing your
                                                    order'}}</span><br>
                                                TrackingId : <span>{{trackingId || 'We are processing your
                                                    order'}}</span>
                                            </th>
                                            <th colspan="3" class="text-end">
                                                <span class="text-muted">Total Price</span> <br>
                                                <strong>₹ {{totalPrice}}</strong>
                                            </th>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="text-center my-3">
                                <button class="btn btn-primary" (click)="screentoggle('Orders')">Back to Orders</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Orders List -->
            <div class="col-12 col-lg-8" *ngIf="isOrder">
                <ng-container *ngIf="orders.length === 0">
                    <div class="alert alert-warning text-center">
                        <strong>No Orders yet. Place order to receive items. To process <a
                                [routerLink]="['/user/productsList']">click here</a>.</strong>
                    </div>
                </ng-container>
                <ng-container *ngIf="orders.length >= 1">
                    <div>
                        <div class="card">
                            <div class="card-body">
                                <div class="top-status">
                                    <h5>ORDER #{{orders[0].orderId}}</h5>
                                    <ul>
                                        <li *ngFor="let statusMsg of getCurrentState(); let i = index"
                                            [ngClass]="{'active': true}">
                                            <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1"
                                                *ngIf="orders[0].status !== 'CANCELLED'" viewBox="0 0 512 512"
                                                width="50" height="50">
                                                <title> Clock Delivery package </title>
                                                <path
                                                    d="M316.96,424.4A96,96,0,1,1,400,472.22,95.391,95.391,0,0,1,316.96,424.4Z"
                                                    style="fill:#6fe3ff" />
                                                <path
                                                    d="M400,135.55V280.22A96.008,96.008,0,0,0,316.96,424.4L208,487.3V246.38L399.98,135.54Z"
                                                    style="fill:#c16752" />
                                                <polygon
                                                    points="208 246.38 141.14 207.78 333.13 96.94 399.98 135.54 208 246.38"
                                                    style="fill:#e48e66" />
                                                <polygon
                                                    points="333.13 96.94 141.14 207.78 92.21 179.53 284.19 68.69 333.13 96.94"
                                                    style="fill:#e5d45a" />
                                                <polygon
                                                    points="208 24.7 284.19 68.69 92.21 179.53 92.2 179.53 16.02 135.54 208 24.7"
                                                    style="fill:#af593c" />
                                                <polygon
                                                    points="208 246.38 208 487.3 16 376.45 16 135.55 16.02 135.54 92.2 179.53 92.2 339.28 115.45 329.68 140.8 358.48 140.8 207.98 141.14 207.78 208 246.38"
                                                    style="fill:#e48e66" />
                                                <polygon
                                                    points="141.14 207.78 140.8 207.98 140.8 358.48 115.45 329.68 92.2 339.28 92.2 179.53 92.21 179.53 141.14 207.78"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M284.75,269.594l-17.9-18.959a7,7,0,0,0-11.256,1.49l-16.9,31.44a7,7,0,0,0,6.16,10.316,7.185,7.185,0,0,0,6.292-3.687L255,283.247V343.42a7,7,0,1,0,14,0V273.051l5.69,6.154a6.927,6.927,0,0,0,9.835.285A7,7,0,0,0,284.75,269.594Z"
                                                    style="fill:#6fe3ff" />
                                                <path
                                                    d="M40.83,378.37a7,7,0,0,1-7-7V345.45a7,7,0,0,1,14,0v25.92A7,7,0,0,1,40.83,378.37Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M69.25,395a7,7,0,0,1-7-7V364.65a7,7,0,0,1,14,0V388A7,7,0,0,1,69.25,395Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M97.68,411.41a7,7,0,0,1-7-7V383.85a7,7,0,0,1,14,0v20.56A7,7,0,0,1,97.68,411.41Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M126.1,427.82a7,7,0,0,1-7-7V403.05a7,7,0,0,1,14,0v17.77A7,7,0,0,1,126.1,427.82Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M154.52,444.61a7,7,0,0,1-7-7V422.25a7,7,0,0,1,14,0v15.36A7,7,0,0,1,154.52,444.61Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M247.777,384.941a7,7,0,0,1-3.507-13.064l31.89-18.41a7,7,0,0,1,7,12.125L251.27,384A6.964,6.964,0,0,1,247.777,384.941Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M432.039,413.22a6.975,6.975,0,0,1-4.783-1.89l-32.04-30A7,7,0,0,1,393,376.22V313.97a7,7,0,0,1,14,0v59.215l29.824,27.925a7,7,0,0,1-4.785,12.11Z"
                                                    style="fill:#2561a1" />
                                            </svg>
                                            <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1"
                                                *ngIf="orders[0].status === 'CANCELLED'" viewBox="0 0 512 512"
                                                width="50" height="50">
                                                <title> Clock Delivery package </title>
                                                <path
                                                    d="M316.96,424.4A96,96,0,1,1,400,472.22,95.391,95.391,0,0,1,316.96,424.4Z"
                                                    style="fill:#b6cdd3" />
                                                <path
                                                    d="M400,135.55V280.22A96.008,96.008,0,0,0,316.96,424.4L208,487.3V246.38L399.98,135.54Z"
                                                    style="fill:#bda9a5" />
                                                <polygon
                                                    points="208 246.38 141.14 207.78 333.13 96.94 399.98 135.54 208 246.38"
                                                    style="fill:#bda9a5" />
                                                <polygon
                                                    points="333.13 96.94 141.14 207.78 92.21 179.53 284.19 68.69 333.13 96.94"
                                                    style="fill:#e5d45a" />
                                                <polygon
                                                    points="208 24.7 284.19 68.69 92.21 179.53 92.2 179.53 16.02 135.54 208 24.7"
                                                    style="fill:#bda9a5" />
                                                <polygon
                                                    points="208 246.38 208 487.3 16 376.45 16 135.55 16.02 135.54 92.2 179.53 92.2 339.28 115.45 329.68 140.8 358.48 140.8 207.98 141.14 207.78 208 246.38"
                                                    style="fill:#bda9a5" />
                                                <polygon
                                                    points="141.14 207.78 140.8 207.98 140.8 358.48 115.45 329.68 92.2 339.28 92.2 179.53 92.21 179.53 141.14 207.78"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M284.75,269.594l-17.9-18.959a7,7,0,0,0-11.256,1.49l-16.9,31.44a7,7,0,0,0,6.16,10.316,7.185,7.185,0,0,0,6.292-3.687L255,283.247V343.42a7,7,0,1,0,14,0V273.051l5.69,6.154a6.927,6.927,0,0,0,9.835.285A7,7,0,0,0,284.75,269.594Z"
                                                    style="fill:#6fe3ff" />
                                                <path
                                                    d="M40.83,378.37a7,7,0,0,1-7-7V345.45a7,7,0,0,1,14,0v25.92A7,7,0,0,1,40.83,378.37Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M69.25,395a7,7,0,0,1-7-7V364.65a7,7,0,0,1,14,0V388A7,7,0,0,1,69.25,395Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M97.68,411.41a7,7,0,0,1-7-7V383.85a7,7,0,0,1,14,0v20.56A7,7,0,0,1,97.68,411.41Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M126.1,427.82a7,7,0,0,1-7-7V403.05a7,7,0,0,1,14,0v17.77A7,7,0,0,1,126.1,427.82Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M154.52,444.61a7,7,0,0,1-7-7V422.25a7,7,0,0,1,14,0v15.36A7,7,0,0,1,154.52,444.61Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M247.777,384.941a7,7,0,0,1-3.507-13.064l31.89-18.41a7,7,0,0,1,7,12.125L251.27,384A6.964,6.964,0,0,1,247.777,384.941Z"
                                                    style="fill:#f8ec7d" />
                                                <path
                                                    d="M432.039,413.22a6.975,6.975,0,0,1-4.783-1.89l-32.04-30A7,7,0,0,1,393,376.22V313.97a7,7,0,0,1,14,0v59.215l29.824,27.925a7,7,0,0,1-4.785,12.11Z"
                                                    style="fill:#da1818" />
                                            </svg>
                                            <span>{{statusMsg}}</span>
                                        </li>
                                        <li
                                            *ngIf="orders[0].status === 'CANCELLED' || orders[0].status === 'REFUNDED' || orders[0].status === 'RETURNED' || orders[0].status === 'FAILED'">
                                            <span>{{orders[0].status}}</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="card mt-4">
                            <div class="card-body p-0 table-responsive">
                                <h4 class="p-3 mb-0">Your Orders</h4>
                                <div class="table-responsive">
                                    <table class="table mb-0">
                                        <thead>
                                            <tr>
                                                <th scope="col">Order ID</th>
                                                <th scope="col">Date</th>
                                                <th scope="col" colspan="2">Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let order of orders; let i = index">
                                                <td>
                                                    <a style="cursor: pointer;"
                                                        (click)="showOrderStatus(i)">{{order.orderId}}</a>
                                                </td>
                                                <td>{{order.orderDate | date: 'd/MM'}}</td>
                                                <td colspan="2">
                                                    <strong>
                                                        <span class="badge bg-warning text-dark">{{order.status}}</span>
                                                    </strong>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
            <!-- Billing/Shipping Form -->
            <div class="col-12 col-lg-8" *ngIf="isAdd">
                <div class="form__name">Billing Form</div>
                <div class="form__container">
                    <section class="form__personal">
                        <div class="sections d-flex align-items-center mb-3">
                            <div class="box me-2">1</div><span>Personal Information</span>
                        </div>
                        <div class="personal--form">
                            <form class="form--name" action="">
                                <div class="row g-3">
                                    <div class="col-12 col-md-6 mb-3">
                                        <label for="firstname">First Name</label>
                                        <input placeholder="e.g. Richard" [value]="name.fName" id="firstname"
                                            type="text" class="form-control" disabled />
                                    </div>
                                    <div class="col-12 col-md-6 mb-3">
                                        <label for="lastname">Last Name</label>
                                        <input placeholder="e.g. Bovell" [value]="name.lName" id="lastname" type="text"
                                            class="form-control" disabled />
                                    </div>
                                    <div class="col-12 col-md-6 mb-3">
                                        <label for="email">Email</label>
                                        <input placeholder="e.g. rb@apple.com" id="email" [value]="userdetails.email"
                                            type="email" class="form-control" disabled />
                                    </div>
                                    <div class="col-12 col-md-6 mb-3">
                                        <label for="contact">Contact</label>
                                        <input placeholder="e.g. 9876543210" id="contact" type="text"
                                            [value]="userdetails.phoneNumber" class="form-control" disabled />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </section>
                    <section class="form__billing mt-4">
                        <div class="sections d-flex align-items-center mb-3">
                            <div class="box billing me-2">2</div><span>Billing Address</span>
                        </div>
                        <div class="shipping--form">
                            <form class="form--shipping row g-3" [formGroup]="addressForm" action="">
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="address-one">Address Line 1</label>
                                    <input placeholder="e.g. 1 Infinite Loop" id="address-one" type="text" name="AddL1"
                                        formControlName="addressL1" class="form-control" />
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="address-two">Address Line 2</label>
                                    <input id="address-two" type="text" name="addL2" formControlName="addressL2"
                                        class="form-control" />
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="city">City</label>
                                    <input placeholder="e.g. Cupertino" id="city" type="text" name="City"
                                        formControlName="city" class="form-control" />
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="state">State / Province / Region</label>
                                    <input placeholder="e.g. California" id="state" type="text" name="state"
                                        formControlName="state" class="form-control" />
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="zip">Zip / Postal Code</label>
                                    <input placeholder="e.g. 95014" id="zip" type="text" name="zip"
                                        formControlName="zip" maxlength="6" (input)="restrictText($event)"
                                        class="form-control" />
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="country">Country</label>
                                    <input placeholder="e.g. U.S.A" id="country" type="text" name="country"
                                        formControlName="country" class="form-control" />
                                </div>
                            </form>
                        </div>
                    </section>
                    <div class="form__confirmation text-end text-md-end mt-3">
                        <button class="btn btn-warning w-100 w-md-auto" [disabled]="addressForm.invalid"
                            (click)="confirmOrder()">Place Order</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>